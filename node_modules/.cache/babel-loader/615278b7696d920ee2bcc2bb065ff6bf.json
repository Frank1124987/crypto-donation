{"remainingRequest":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\src\\components\\nft\\RegisterNFT.vue?vue&type=template&id=47254b46&scoped=true","dependencies":[{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\src\\components\\nft\\RegisterNFT.vue","mtime":1640104029002},{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1632349277000},{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1632349277000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCB7IGNyZWF0ZUVsZW1lbnRWTm9kZSBhcyBfY3JlYXRlRWxlbWVudFZOb2RlLCB2TW9kZWxUZXh0IGFzIF92TW9kZWxUZXh0LCB3aXRoRGlyZWN0aXZlcyBhcyBfd2l0aERpcmVjdGl2ZXMsIHJlbmRlckxpc3QgYXMgX3JlbmRlckxpc3QsIEZyYWdtZW50IGFzIF9GcmFnbWVudCwgb3BlbkJsb2NrIGFzIF9vcGVuQmxvY2ssIGNyZWF0ZUVsZW1lbnRCbG9jayBhcyBfY3JlYXRlRWxlbWVudEJsb2NrLCB0b0Rpc3BsYXlTdHJpbmcgYXMgX3RvRGlzcGxheVN0cmluZywgdk1vZGVsU2VsZWN0IGFzIF92TW9kZWxTZWxlY3QsIHdpdGhNb2RpZmllcnMgYXMgX3dpdGhNb2RpZmllcnMsIHdpdGhTY29wZUlkIGFzIF93aXRoU2NvcGVJZCwgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCl9wdXNoU2NvcGVJZCgiZGF0YS12LTQ3MjU0YjQ2Iik7Cgp2YXIgX2hvaXN0ZWRfMSA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJsYWJlbCIsIHsKICBmb3I6ICJuYW1lIgp9LCAiTkZU5ZCN56ix77yaIiwgLTEKLyogSE9JU1RFRCAqLwopOwoKdmFyIF9ob2lzdGVkXzIgPSAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiYnIiLCBudWxsLCBudWxsLCAtMQovKiBIT0lTVEVEICovCik7Cgp2YXIgX2hvaXN0ZWRfMyA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJsYWJlbCIsIHsKICBmb3I6ICJkZXNjcmlwdGlvbiIKfSwgIuaPj+i/sO+8miIsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF80ID0gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImJyIiwgbnVsbCwgbnVsbCwgLTEKLyogSE9JU1RFRCAqLwopOwoKdmFyIF9ob2lzdGVkXzUgPSAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiYnIiLCBudWxsLCBudWxsLCAtMQovKiBIT0lTVEVEICovCik7Cgp2YXIgX2hvaXN0ZWRfNiA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJzcGFuIiwgbnVsbCwgIumBuOaTh+aOm+mJpOeahOWwiOahiO+8miIsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF83ID0gLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImJyIiwgbnVsbCwgbnVsbCwgLTEKLyogSE9JU1RFRCAqLwopOwoKdmFyIF9ob2lzdGVkXzggPSAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgibGFiZWwiLCB7CiAgZm9yOiAiZm9ybUZpbGUiLAogIGNsYXNzOiAiZm9ybS1sYWJlbCIKfSwgIlVwbG9hZCBJbWFnZe+8miIsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF85ID0gWyJzcmMiXTsKCnZhciBfaG9pc3RlZF8xMCA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJiciIsIG51bGwsIG51bGwsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF8xMSA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJpbnB1dCIsIHsKICB0eXBlOiAic3VibWl0IiwKICB2YWx1ZTogIuaPkOS6pCIKfSwgbnVsbCwgLTEKLyogSE9JU1RFRCAqLwopOwoKX3BvcFNjb3BlSWQoKTsKCmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoX2N0eCwgX2NhY2hlLCAkcHJvcHMsICRzZXR1cCwgJGRhdGEsICRvcHRpb25zKSB7CiAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImZvcm0iLCB7CiAgICBvblN1Ym1pdDogX2NhY2hlWzRdIHx8IChfY2FjaGVbNF0gPSBfd2l0aE1vZGlmaWVycyhmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc2V0dXAucmVnaXN0ZXJORlQgJiYgJHNldHVwLnJlZ2lzdGVyTkZULmFwcGx5KCRzZXR1cCwgYXJndW1lbnRzKTsKICAgIH0sIFsicHJldmVudCJdKSkKICB9LCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgbnVsbCwgW19ob2lzdGVkXzEsIF9ob2lzdGVkXzIsIF93aXRoRGlyZWN0aXZlcyhfY3JlYXRlRWxlbWVudFZOb2RlKCJpbnB1dCIsIHsKICAgIGlkOiAibmFtZSIsCiAgICB0eXBlOiAidGV4dCIsCiAgICAib25VcGRhdGU6bW9kZWxWYWx1ZSI6IF9jYWNoZVswXSB8fCAoX2NhY2hlWzBdID0gZnVuY3Rpb24gKCRldmVudCkgewogICAgICByZXR1cm4gJHNldHVwLm5hbWUgPSAkZXZlbnQ7CiAgICB9KQogIH0sIG51bGwsIDUxMgogIC8qIE5FRURfUEFUQ0ggKi8KICApLCBbW192TW9kZWxUZXh0LCAkc2V0dXAubmFtZV1dKV0pLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBudWxsLCBbX2hvaXN0ZWRfMywgX2hvaXN0ZWRfNCwgX3dpdGhEaXJlY3RpdmVzKF9jcmVhdGVFbGVtZW50Vk5vZGUoImlucHV0IiwgewogICAgaWQ6ICJkZXNjcmlwdGlvbiIsCiAgICB0eXBlOiAidGV4dCIsCiAgICAib25VcGRhdGU6bW9kZWxWYWx1ZSI6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gZnVuY3Rpb24gKCRldmVudCkgewogICAgICByZXR1cm4gJHNldHVwLmRlc2NyaXB0aW9uID0gJGV2ZW50OwogICAgfSkKICB9LCBudWxsLCA1MTIKICAvKiBORUVEX1BBVENIICovCiAgKSwgW1tfdk1vZGVsVGV4dCwgJHNldHVwLmRlc2NyaXB0aW9uXV0pXSksIF9ob2lzdGVkXzUsIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIG51bGwsIFtfaG9pc3RlZF82LCBfd2l0aERpcmVjdGl2ZXMoX2NyZWF0ZUVsZW1lbnRWTm9kZSgic2VsZWN0IiwgewogICAgIm9uVXBkYXRlOm1vZGVsVmFsdWUiOiBfY2FjaGVbMl0gfHwgKF9jYWNoZVsyXSA9IGZ1bmN0aW9uICgkZXZlbnQpIHsKICAgICAgcmV0dXJuICRzZXR1cC5zZWxlY3RlZFBsYW4gPSAkZXZlbnQ7CiAgICB9KQogIH0sIFsoX29wZW5CbG9jayh0cnVlKSwgX2NyZWF0ZUVsZW1lbnRCbG9jayhfRnJhZ21lbnQsIG51bGwsIF9yZW5kZXJMaXN0KCRzZXR1cC5wbGFucywgZnVuY3Rpb24gKHBsYW4sIGlkKSB7CiAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJvcHRpb24iLCB7CiAgICAgIGtleTogaWQKICAgIH0sIF90b0Rpc3BsYXlTdHJpbmcocGxhbi5uYW1lKSwgMQogICAgLyogVEVYVCAqLwogICAgKTsKICB9KSwgMTI4CiAgLyogS0VZRURfRlJBR01FTlQgKi8KICApKV0sIDUxMgogIC8qIE5FRURfUEFUQ0ggKi8KICApLCBbW192TW9kZWxTZWxlY3QsICRzZXR1cC5zZWxlY3RlZFBsYW5dXSldKSwgX2hvaXN0ZWRfNywgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgbnVsbCwgW19ob2lzdGVkXzgsIF9jcmVhdGVFbGVtZW50Vk5vZGUoImlucHV0IiwgewogICAgY2xhc3M6ICJmb3JtLWNvbnRyb2wiLAogICAgdHlwZTogImZpbGUiLAogICAgb25JbnB1dDogX2NhY2hlWzNdIHx8IChfY2FjaGVbM10gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc2V0dXAucGlja0ZpbGUgJiYgJHNldHVwLnBpY2tGaWxlLmFwcGx5KCRzZXR1cCwgYXJndW1lbnRzKTsKICAgIH0pLAogICAgYWNjZXB0OiAiaW1hZ2UvKiIKICB9LCBudWxsLCAzMgogIC8qIEhZRFJBVEVfRVZFTlRTICovCiAgKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaW1nIiwgewogICAgaWQ6ICJuZnQtcHJldmlldy1pbWciLAogICAgc3JjOiAkc2V0dXAuaW1hZ2UsCiAgICBhbHQ6ICIiCiAgfSwgbnVsbCwgOAogIC8qIFBST1BTICovCiAgLCBfaG9pc3RlZF85KV0pLCBfaG9pc3RlZF8xMCwgX2hvaXN0ZWRfMTFdLCAzMgogIC8qIEhZRFJBVEVfRVZFTlRTICovCiAgKV0pOwp9"},{"version":3,"sources":["C:\\Users\\G501VW\\Desktop\\0817\\crypto-donation\\src\\components\\nft\\RegisterNFT.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <form @submit.prevent=\"registerNFT\">\r\n            <div>\r\n                <label for=\"name\">NFT名稱：</label>\r\n                <br>\r\n                <input id=\"name\" type=\"text\" v-model=\"name\" >\r\n            </div>\r\n            <div>\r\n                <label for=\"description\">描述：</label>\r\n                <br>\r\n                <input id=\"description\" type=\"text\" v-model=\"description\">\r\n            </div>\r\n            <br>\r\n            <div>\r\n                <span>選擇掛鉤的專案：</span>\r\n                <select v-model=\"selectedPlan\">\r\n                    <option v-for=\"(plan, id) in plans\" :key=id>\r\n                        {{plan.name}}\r\n                    </option>\r\n                </select>\r\n            </div>\r\n            <br>\r\n            <div>\r\n                <label for=\"formFile\" class=\"form-label\">Upload Image：</label>\r\n                <input class=\"form-control\" type=\"file\" @input=\"pickFile\" accept=\"image/*\">\r\n                <img id=\"nft-preview-img\" :src=\"image\" alt=\"\">\r\n            </div>\r\n            <br>\r\n            <input type=\"submit\" value=\"提交\">\r\n        </form>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {ref, computed} from 'vue'\r\nimport {useStore} from 'vuex'\r\nimport {useRoute, useRouter} from 'vue-router'\r\nimport {web3, contract} from '@/contract/contract.js'\r\nimport {NFTStorage, File} from 'nft.storage'\r\n// import {pack} from 'ipfs-car/pack'\r\nimport * as fs from 'fs'\r\n\r\nexport default {\r\n    props: {\r\n        plans: {\r\n            type: Object\r\n        }\r\n    },\r\n    setup(props){\r\n        const route = useRoute()\r\n\r\n        const name = ref(\"\");\r\n        const description = ref(\"\");\r\n        const image = ref(\"\");\r\n        const selectedPlan = ref(\"\")\r\n\r\n        const plans = ref(props.plans)\r\n\r\n        let image_temp = null\r\n        const pickFile = (event) => {\r\n            const reader = new FileReader()\r\n            reader.onload = (e) => {\r\n                image.value = e.target.result;\r\n            }\r\n\r\n            image_temp = event.target.files[0]\r\n            reader.readAsDataURL(event.target.files[0])\r\n        }\r\n\r\n        const registerNFT = async () => {\r\n            const apiKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweDY0Q2NGNEVlMEM4N2I2QjZlNEFDRTRFQWRiNzg0MGQ0RjUyMjMxMTciLCJpc3MiOiJuZnQtc3RvcmFnZSIsImlhdCI6MTYzOTU0NDQyNTgwNCwibmFtZSI6ImNyeXB0X2RvbmF0aW9uIn0.iGh9m27-DncOEfMl0vBEy8fPWIKY32eeQLkmatfawbI'\r\n            const client = new NFTStorage({token : apiKey})\r\n            const metadata = await client.store({\r\n                name: name.value,\r\n                description: description.value,\r\n                image: image_temp\r\n            })\r\n            const address = await web3.eth.getAccounts()\r\n\r\n            contract.methods.register_nft(route.params.departmentId, name.value, metadata.url).send({\r\n                from: address[0],\r\n                gas : 9187500,\r\n            }).then(() => {\r\n                contract.methods.addNFTToPlan(route.params.departmentId, selectedPlan.value, name.value).send({\r\n                    from: address[0],\r\n                    gas : 9187500,      \r\n                }).then(console.log)\r\n                .catch(console.log)\r\n            }).catch(err => {\r\n                console.log(\"error: \", err)\r\n            })\r\n        }\r\n\r\n\r\n        return {\r\n            name,\r\n            description,\r\n            image,\r\n            plans,\r\n            selectedPlan,\r\n            pickFile,\r\n            registerNFT\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.imagePreviewWrapper {\r\n  background-repeat: no-repeat;\r\n    width: 250px;\r\n    height: 250px;\r\n    display: block;\r\n    cursor: pointer;\r\n    margin: 0 auto 30px;\r\n    background-size: contain;\r\n    background-position: center center;\r\n}\r\n\r\n#nft-preview-img {\r\n    width: 80%;\r\n}\r\n</style>"],"sourceRoot":""}]}